<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{admin/layout :: layout(~{::content}, 'Ch·ªânh s·ª≠a m√≥n ƒÉn', 'C·∫≠p nh·∫≠t th√¥ng tin m√≥n ƒÉn', 'foods')}">
<div th:fragment="content">
    <div class="max-w-5xl mx-auto">
        <div class="bg-gradient-to-br from-white to-orange-50 rounded-2xl shadow-2xl border border-orange-100 overflow-hidden">
            <form th:action="@{/admin/foods/{id}/edit(id=${foodItem.id})}" th:object="${foodItem}" method="post" enctype="multipart/form-data">
                <div class="bg-gradient-to-r from-orange-600 to-amber-600 px-6 pt-5 pb-3">
                    <h3 class="text-2xl font-bold text-white">Ch·ªânh s·ª≠a m√≥n ƒÉn</h3>
                </div>
                <div class="px-6 pt-5 pb-5 sm:p-6">
                    <div class="max-w-2xl mx-auto">
                        <!-- Th√¥ng tin c∆° b·∫£n -->
                        <div class="space-y-5">
                            <div class="bg-white/60 rounded-xl p-4 border border-orange-100">
                                <h4 class="text-base font-bold text-orange-800 mb-4 flex items-center">
                                    <span class="mr-2">üìù</span> Th√¥ng tin c∆° b·∫£n
                                </h4>
                                <div class="space-y-4">
                                    <div>
                                        <label for="name" class="block text-sm font-semibold text-gray-700 mb-1.5">T√™n m√≥n ƒÉn *</label>
                                        <input type="text" th:field="*{name}" id="name" class="block w-full px-4 py-2.5 rounded-lg border-2 border-orange-200 bg-white shadow-sm focus:border-orange-500 focus:ring-2 focus:ring-orange-300 text-sm transition-all" required>
                                    </div>
                                    <div>
                                        <label for="category" class="block text-sm font-semibold text-gray-700 mb-1.5">Danh m·ª•c *</label>
                                        <select th:field="*{category}" id="category" class="block w-full px-4 py-2.5 rounded-lg border-2 border-orange-200 bg-white shadow-sm focus:border-orange-500 focus:ring-2 focus:ring-orange-300 text-sm transition-all" required>
                                            <option value="">-- Ch·ªçn danh m·ª•c --</option>
                                            <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.icon + ' ' + cat.name}" th:selected="${cat.id == foodItem.category.id}"></option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="unit" class="block text-sm font-semibold text-gray-700 mb-1.5">ƒê∆°n v·ªã m·∫∑c ƒë·ªãnh *</label>
                                        <select th:field="*{unit}" id="unit" class="block w-full px-4 py-2.5 rounded-lg border-2 border-orange-200 bg-white shadow-sm focus:border-orange-500 focus:ring-2 focus:ring-orange-300 text-sm transition-all" required>
                                            <option value="g" th:selected="${foodItem.unit == 'g'}">g - Gram</option>
                                            <option value="kg" th:selected="${foodItem.unit == 'kg'}">kg - Kilogram</option>
                                            <option value="ml" th:selected="${foodItem.unit == 'ml'}">ml - Milliliter</option>
                                            <option value="l" th:selected="${foodItem.unit == 'l'}">l - Liter</option>
                                            <option value="qu·∫£" th:selected="${foodItem.unit == 'qu·∫£'}">qu·∫£ - Qu·∫£/C√°i</option>
                                            <option value="c·ªëc" th:selected="${foodItem.unit == 'c·ªëc'}">c·ªëc - C·ªëc</option>
                                            <option value="th√¨a canh" th:selected="${foodItem.unit == 'th√¨a canh'}">th√¨a canh - Th√¨a canh</option>
                                            <option value="th√¨a c√† ph√™" th:selected="${foodItem.unit == 'th√¨a c√† ph√™'}">th√¨a c√† ph√™ - Th√¨a c√† ph√™</option>
                                            <option value="l√°t" th:selected="${foodItem.unit == 'l√°t'}">l√°t - L√°t</option>
                                            <option value="t√©p" th:selected="${foodItem.unit == 't√©p'}">t√©p - T√©p</option>
                                        </select>
                                        <p class="mt-1 text-xs text-gray-500">ƒê∆°n v·ªã ƒëo l∆∞·ªùng m·∫∑c ƒë·ªãnh cho nguy√™n li·ªáu n√†y</p>
                                    </div>
                                    <div>
                                        <label for="calories" class="block text-sm font-semibold text-gray-700 mb-1.5">Calories *</label>
                                        <div class="relative">
                                            <input type="number" id="calories-input" step="0.1" min="0" class="block w-full px-4 py-2.5 pr-16 rounded-lg border-2 border-orange-200 bg-white shadow-sm focus:border-orange-500 focus:ring-2 focus:ring-orange-300 text-sm transition-all" placeholder="52" required>
                                            <span class="absolute right-4 top-1/2 -translate-y-1/2 text-sm font-medium text-gray-500">kcal</span>
                                            <input type="hidden" th:field="*{calories}" id="calories">
                                        </div>
                                        <p class="mt-1 text-xs text-gray-500">Ch·ªâ c·∫ßn nh·∫≠p s·ªë, h·ªá th·ªëng t·ª± ƒë·ªông th√™m ƒë∆°n v·ªã kcal</p>
                                    </div>
                                    <div>
                                        <label for="description" class="block text-sm font-semibold text-gray-700 mb-1.5">M√¥ t·∫£</label>
                                        <textarea th:field="*{description}" id="description" rows="4" class="block w-full px-4 py-2.5 rounded-lg border-2 border-orange-200 bg-white shadow-sm focus:border-orange-500 focus:ring-2 focus:ring-orange-300 text-sm transition-all resize-none"></textarea>
                                    </div>
                                    <div>
                                        <label for="imageFile" class="block text-sm font-semibold text-gray-700 mb-1.5">H√¨nh ·∫£nh</label>
                                        <input type="file" name="imageFile" id="imageFile" accept="image/*" class="block w-full px-4 py-2.5 rounded-lg border-2 border-orange-200 bg-white shadow-sm text-gray-700 text-sm file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-orange-500 file:text-white hover:file:bg-orange-600 transition-all">
                                        <p class="mt-1.5 text-xs text-gray-500">ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng mu·ªën thay ƒë·ªïi h√¨nh ·∫£nh</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 px-6 py-4 sm:flex sm:flex-row-reverse sm:gap-3 border-t border-orange-200">
                    <button type="submit" class="inline-flex w-full justify-center items-center rounded-xl border border-transparent bg-gradient-to-r from-orange-500 via-amber-500 to-red-500 px-8 py-3 text-base font-bold text-white shadow-lg hover:from-orange-600 hover:via-amber-600 hover:to-red-600 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 transition-all duration-300 transform hover:scale-105 hover:shadow-xl sm:w-auto">
                        <span class="mr-2">‚úì</span> L∆∞u thay ƒë·ªïi
                    </button>
                    <a th:href="@{/admin/foods}" class="mt-3 inline-flex w-full justify-center items-center rounded-xl border-2 border-orange-300 bg-white px-8 py-3 text-base font-bold text-orange-700 shadow-md hover:bg-orange-50 hover:border-orange-400 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:ring-offset-2 transition-all duration-300 sm:mt-0 sm:w-auto">
                        <span class="mr-2">‚úï</span> H·ªßy
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Extract number from calories value (e.g., "52 kcal" -> "52")
        const caloriesField = document.getElementById('calories');
        const caloriesInput = document.getElementById('calories-input');
        if (caloriesField && caloriesInput && caloriesField.value) {
            const caloriesNumber = caloriesField.value.replace(/\s*kcal\s*/i, '').trim();
            caloriesInput.value = caloriesNumber;
        }
        
        // Update hidden field when input changes
        if (caloriesInput) {
            caloriesInput.addEventListener('input', function() {
                if (caloriesField && this.value) {
                    caloriesField.value = this.value + ' kcal';
                }
            });
        }
        
        // Update on form submit
        const form = document.querySelector('form');
        if (form) {
            form.addEventListener('submit', function(e) {
                if (caloriesInput && caloriesField && caloriesInput.value) {
                    caloriesField.value = caloriesInput.value + ' kcal';
                }
            });
        }
    });
</script>
</html>
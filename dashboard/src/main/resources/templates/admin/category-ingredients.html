<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{admin/layout :: layout(~{::content}, 'Nguy√™n li·ªáu', 'Danh s√°ch nguy√™n li·ªáu', 'categories')}">
<div th:fragment="content">

    <!-- Header v·ªõi n√∫t quay l·∫°i v√† th√™m nguy√™n li·ªáu -->
    <div class="bg-white rounded-xl shadow-md p-6 mb-6 border border-emerald-100">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div class="flex items-center gap-4">
                <a th:href="@{/admin/categories}" class="inline-flex items-center text-emerald-600 hover:text-emerald-700 font-medium transition-colors">
                    <i class="fa-solid fa-arrow-left mr-2"></i>
                    <span class="hidden sm:inline">Quay l·∫°i</span>
                </a>
                <div class="h-px w-px bg-gray-300 hidden md:block"></div>
                <div class="flex items-center gap-4">
                    <div class="flex h-16 w-16 items-center justify-center rounded-2xl shadow-sm" th:style="'background: linear-gradient(135deg, ' + ${category.color} + '30, ' + ${category.color} + '10); border: 2px solid ' + ${category.color} + '20;'">
                        <span class="text-4xl" th:text="${category.icon}"></span>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900" th:text="'Nguy√™n li·ªáu: ' + ${category.name}"></h2>
                        <p class="text-sm text-gray-500 mt-1" th:text="${category.description}"></p>
                    </div>
                </div>
            </div>
            <div class="flex-shrink-0">
                <button type="button" onclick="openModal('addIngredientModal')" class="inline-flex items-center justify-center rounded-xl border border-transparent bg-gradient-to-r from-emerald-500 to-teal-500 px-6 py-3 text-base font-bold text-white shadow-lg hover:from-emerald-600 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-2xl">
                    <i class="fas fa-plus mr-2"></i> Th√™m nguy√™n li·ªáu
                </button>
            </div>
        </div>
    </div>

    <!-- Flash Messages -->
    <div th:if="${success}" class="mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg">
        <i class="fa-solid fa-check-circle mr-2"></i><span th:text="${success}"></span>
    </div>
    <div th:if="${error}" class="mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg">
        <i class="fa-solid fa-exclamation-circle mr-2"></i><span th:text="${error}"></span>
    </div>

    <!-- Search and Filter Bar -->
    <div class="mb-6 bg-white rounded-xl shadow-md p-6 border border-emerald-100">
        <form th:action="@{/admin/categories/{id}/ingredients(id=${category.id})}" method="GET" class="flex flex-col md:flex-row gap-4">
            <!-- Search Input -->
            <div class="flex-1">
                <label for="search" class="block text-sm font-medium text-emerald-700 mb-2">
                    <i class="fa-solid fa-search mr-1"></i>T√¨m ki·∫øm
                </label>
                <div class="relative">
                    <input type="text" 
                           id="search" 
                           name="search" 
                           th:value="${search}"
                           placeholder="T√¨m theo t√™n nguy√™n li·ªáu, m√¥ t·∫£..."
                           class="w-full pl-10 pr-4 py-2.5 border-2 border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all">
                    <i class="fa-solid fa-search absolute left-3 top-3.5 text-emerald-400"></i>
                </div>
            </div>
            
            <!-- Filter by Calories Range -->
            <div class="md:w-48">
                <label for="filterCalories" class="block text-sm font-medium text-emerald-700 mb-2">
                    <i class="fa-solid fa-fire mr-1"></i>Calories
                </label>
                <select id="filterCalories" 
                        name="filterCalories" 
                        th:value="${filterCalories}"
                        class="w-full px-4 py-2.5 border-2 border-emerald-200 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all">
                    <option value="">T·∫•t c·∫£</option>
                    <option value="low">Th·∫•p (&lt; 50 kcal)</option>
                    <option value="medium">Trung b√¨nh (50-150 kcal)</option>
                    <option value="high">Cao (&gt; 150 kcal)</option>
                </select>
            </div>
            
            <!-- Submit Button -->
            <div class="flex items-end">
                <button type="submit" 
                        class="px-6 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-600 text-white font-semibold rounded-lg shadow-md hover:from-emerald-600 hover:to-teal-700 transition-all duration-300 transform hover:scale-105">
                    <i class="fa-solid fa-filter mr-2"></i>T√¨m ki·∫øm
                </button>
            </div>
            
            <!-- Clear Button -->
            <div class="flex items-end" th:if="${search != null and search != '' or filterCalories != null and filterCalories != ''}">
                <a th:href="@{/admin/categories/{id}/ingredients(id=${category.id})}" 
                   class="px-6 py-2.5 bg-gray-200 text-gray-700 font-semibold rounded-lg shadow-md hover:bg-gray-300 transition-all duration-300">
                    <i class="fa-solid fa-times mr-2"></i>X√≥a b·ªô l·ªçc
                </a>
            </div>
        </form>
    </div>

    <!-- Stats Card -->
    <div class="mb-6">
        <div class="bg-gradient-to-br from-emerald-50 to-teal-50 rounded-xl p-6 border-2 border-emerald-200 shadow-md hover:shadow-lg transition-shadow">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-semibold text-emerald-600 uppercase tracking-wide">T·ªïng nguy√™n li·ªáu</p>
                    <p class="text-4xl font-bold text-emerald-900 mt-2" th:text="${#lists.size(ingredients)}">0</p>
                </div>
                <div class="bg-gradient-to-br from-emerald-100 to-teal-100 rounded-xl p-5 shadow-sm">
                    <i class="fa-solid fa-utensils text-3xl text-emerald-600"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Table hi·ªÉn th·ªã nguy√™n li·ªáu -->
    <div class="mt-8 flex flex-col">
        <div class="-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8">
            <div class="inline-block min-w-full py-2 align-middle md:px-6 lg:px-8">
                <div class="overflow-hidden shadow-lg ring-1 ring-emerald-200 md:rounded-2xl bg-white">
                    <table class="min-w-full divide-y divide-emerald-100">
                        <thead class="bg-gradient-to-r from-emerald-50 to-teal-50 border-b border-emerald-200">
                            <tr>
                                <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-bold text-emerald-900 sm:pl-6">Nguy√™n li·ªáu</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-bold text-emerald-900">Calories</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-bold text-emerald-900">ƒê∆°n v·ªã</th>
                                <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-6">
                                    <span class="sr-only">H√†nh ƒë·ªông</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-emerald-100 bg-white">
                            <tr th:each="ingredient : ${ingredients}" class="hover:bg-emerald-50 transition-colors duration-200 border-b border-emerald-100">
                                <td class="py-4 pl-4 pr-3 text-sm sm:pl-6">
                                    <div class="flex items-center">
                                        <div class="h-12 w-12 flex-shrink-0">
                                            <img class="h-12 w-12 rounded-lg object-cover border-2 border-emerald-100" 
                                                 th:src="${(ingredient.imageUrl != null and !#strings.isEmpty(ingredient.imageUrl)) ? ingredient.imageUrl : '/images/default-food.svg'}" 
                                                 alt="·∫¢nh nguy√™n li·ªáu"
                                                 onerror="this.onerror=null; this.src='/images/default-food.svg';">
                                        </div>
                                        <div class="ml-4 min-w-0 flex-1">
                                            <div class="font-semibold text-gray-900 truncate" th:text="${ingredient.name}">T√™n nguy√™n li·ªáu</div>
                                            <div class="text-gray-500 text-xs mt-1 line-clamp-2" th:text="${ingredient.description ?: 'Kh√¥ng c√≥ m√¥ t·∫£'}" 
                                                 th:if="${ingredient.description != null and !#strings.isEmpty(ingredient.description)}">M√¥ t·∫£</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-3 py-4 text-sm">
                                    <div class="flex items-center">
                                        <i class="fa-solid fa-fire text-orange-500 mr-2"></i>
                                        <span class="font-medium text-gray-700" th:text="${ingredient.calories}">52 kcal</span>
                                    </div>
                                </td>
                                <td class="px-3 py-4 text-sm">
                                    <span class="inline-flex items-center px-2.5 py-1 rounded-md bg-emerald-100 text-emerald-700 font-medium text-xs" th:text="${ingredient.unit ?: 'g'}">g</span>
                                </td>
                                <td class="relative py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                                    <div class="flex items-center justify-end gap-2 flex-wrap">
                                        <button type="button" 
                                                class="edit-food-btn inline-flex items-center justify-center rounded-lg bg-gradient-to-r from-emerald-500 to-cyan-600 px-3 py-2 text-sm font-semibold text-white shadow-md hover:from-emerald-600 hover:to-cyan-700 transition-all duration-300 transform hover:scale-105" 
                                                title="S·ª≠a"
                                                th:data-id="${ingredient.id}"
                                                th:data-name="${ingredient.name}"
                                                th:data-category-id="${category.id}"
                                                th:data-calories="${ingredient.calories}"
                                                th:data-description="${ingredient.description ?: ''}"
                                                th:data-unit="${ingredient.unit ?: 'g'}"
                                                th:data-fat="${ingredient.fat ?: 0.0}"
                                                th:data-carbs="${ingredient.carbs ?: 0.0}"
                                                th:data-protein="${ingredient.protein ?: 0.0}"
                                                th:data-cholesterol="${ingredient.cholesterol ?: 0.0}"
                                                th:data-sodium="${ingredient.sodium ?: 0.0}"
                                                th:data-vitamin="${ingredient.vitamin ?: 0.0}"
                                                th:data-vitamin-a="${ingredient.vitaminA ?: 0.0}"
                                                th:data-vitamin-b1="${ingredient.vitaminB1 ?: 0.0}"
                                                th:data-vitamin-b2="${ingredient.vitaminB2 ?: 0.0}"
                                                th:data-vitamin-b3="${ingredient.vitaminB3 ?: 0.0}"
                                                th:data-vitamin-b6="${ingredient.vitaminB6 ?: 0.0}"
                                                th:data-vitamin-b9="${ingredient.vitaminB9 ?: 0.0}"
                                                th:data-vitamin-b12="${ingredient.vitaminB12 ?: 0.0}"
                                                th:data-vitamin-c="${ingredient.vitaminC ?: 0.0}"
                                                th:data-vitamin-d="${ingredient.vitaminD ?: 0.0}"
                                                th:data-vitamin-e="${ingredient.vitaminE ?: 0.0}"
                                                th:data-vitamin-k="${ingredient.vitaminK ?: 0.0}">
                                            <i class="fa-solid fa-pen h-4 w-4"></i>
                                            <span class="sr-only">S·ª≠a</span>
                                        </button>
                                        
                                        <form th:action="@{/admin/foods/{id}/delete(id=${ingredient.id})}" method="post" class="inline-block" onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a nguy√™n li·ªáu n√†y?');">
                                            <input type="hidden" name="returnToCategory" th:value="${category.id}">
                                            <button type="submit" class="inline-flex items-center justify-center rounded-lg bg-gradient-to-r from-rose-500 to-red-600 px-3 py-2 text-sm font-semibold text-white shadow-md hover:from-rose-600 hover:to-red-700 transition-all duration-300 transform hover:scale-105" title="X√≥a">
                                                <i class="fa-solid fa-trash h-4 w-4"></i>
                                                <span class="sr-only">X√≥a</span>
                                            </button>
                                        </form>
                                    </div>
                                </td>
                            </tr>

                            <tr th:if="${#lists.isEmpty(ingredients)}">
                                <td colspan="4" class="whitespace-nowrap px-3 py-4 text-sm text-gray-500 text-center">
                                    <div class="py-10">
                                        <i class="fa-solid fa-utensils fa-2x text-gray-400"></i>
                                        <h3 class="mt-2 text-sm font-medium text-gray-900">Ch∆∞a c√≥ nguy√™n li·ªáu n√†o</h3>
                                        <p class="mt-1 text-sm text-gray-500">H√£y th√™m nguy√™n li·ªáu m·ªõi v√†o danh m·ª•c n√†y.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Ingredient Modal (t∆∞∆°ng t·ª± foods.html) -->
    <div id="addIngredientModal" class="relative z-50 hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-black/40 transition-opacity backdrop-blur-sm"></div>
        <div class="fixed inset-0 z-50 overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-2xl bg-gradient-to-br from-white to-emerald-50 text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-5xl border border-emerald-100">
                    <form th:action="@{/admin/foods}" method="post" enctype="multipart/form-data">
                        <input type="hidden" name="returnToCategory" th:value="${category.id}">
                        <input type="hidden" name="category.id" th:value="${category.id}">
                        <div class="bg-gradient-to-r from-emerald-600 to-teal-600 px-6 pt-5 pb-3">
                            <h3 class="text-2xl font-bold text-white" id="modal-title">Th√™m nguy√™n li·ªáu m·ªõi</h3>
                            <p class="text-emerald-100 text-sm mt-1" th:text="'Danh m·ª•c: ' + ${category.name}"></p>
                        </div>
                        <div class="px-6 pt-5 pb-5 sm:p-6">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- C·ªôt tr√°i - Th√¥ng tin c∆° b·∫£n -->
                                <div class="space-y-5">
                                    <div class="bg-white/60 rounded-xl p-4 border border-emerald-100">
                                        <h4 class="text-base font-bold text-emerald-800 mb-4 flex items-center">
                                            <span class="mr-2">üìù</span> Th√¥ng tin c∆° b·∫£n
                                        </h4>
                                        <div class="space-y-4">
                                            <div>
                                                <label for="name" class="block text-sm font-semibold text-gray-700 mb-1.5">T√™n nguy√™n li·ªáu *</label>
                                                <input type="text" name="name" id="name" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" required>
                                            </div>
                                            <div>
                                                <label for="unit" class="block text-sm font-semibold text-gray-700 mb-1.5">ƒê∆°n v·ªã m·∫∑c ƒë·ªãnh *</label>
                                                <select name="unit" id="unit" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" required>
                                                    <option value="g">g - Gram - 100g</option>
                                                    <option value="kg">kg - Kilogram - 1 kg</option>
                                                    <option value="ml">ml - Milliliter - 100ml</option>
                                                    <option value="l">l - Liter - 1 l</option>
                                                    <option value="qu·∫£">qu·∫£ - Qu·∫£/C√°i - 1 qu·∫£</option>
                                                    <option value="c·ªëc">c·ªëc - C·ªëc - 1 c·ªëc</option>
                                                    <option value="th√¨a canh">th√¨a canh - Th√¨a canh - 1 th√¨a canh</option>
                                                    <option value="th√¨a c√† ph√™">th√¨a c√† ph√™ - Th√¨a c√† ph√™ - 1 th√¨a c√† ph√™</option>
                                                    <option value="l√°t">l√°t - L√°t - 1 l√°t</option>
                                                    <option value="t√©p">t√©p - T√©p - 1 t√©p</option>
                                                </select>
                                                <p class="mt-1 text-xs text-gray-500">ƒê∆°n v·ªã ƒëo l∆∞·ªùng m·∫∑c ƒë·ªãnh cho nguy√™n li·ªáu n√†y. <strong>L∆∞u √Ω:</strong> C√°c th√¥ng tin dinh d∆∞·ª°ng b√™n ph·∫£i ƒë∆∞·ª£c t√≠nh tr√™n 100g (ho·∫∑c ƒë∆°n v·ªã t∆∞∆°ng ƒë∆∞∆°ng).</p>
                                            </div>
                                            <div>
                                                <label for="calories" class="block text-sm font-semibold text-gray-700 mb-1.5">Calories *</label>
                                                <div class="relative">
                                                    <input type="number" id="calories" step="0.1" min="0" class="block w-full px-4 py-2.5 pr-16 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="52" required onchange="updateCaloriesValue()">
                                                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-sm font-medium text-gray-500">kcal</span>
                                                    <input type="hidden" name="calories" id="calories-hidden">
                                                </div>
                                                <p class="mt-1 text-xs text-gray-500">Ch·ªâ c·∫ßn nh·∫≠p s·ªë, h·ªá th·ªëng t·ª± ƒë·ªông th√™m ƒë∆°n v·ªã kcal</p>
                                            </div>
                                            <div>
                                                <label for="description" class="block text-sm font-semibold text-gray-700 mb-1.5">M√¥ t·∫£</label>
                                                <textarea name="description" id="description" rows="4" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all resize-none"></textarea>
                                            </div>
                                            <div>
                                                <label for="imageFile" class="block text-sm font-semibold text-gray-700 mb-1.5">H√¨nh ·∫£nh</label>
                                                <input type="file" name="imageFile" id="imageFile" accept="image/*" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm text-gray-700 text-sm file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-emerald-500 file:text-white hover:file:bg-emerald-600 transition-all">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- C·ªôt ph·∫£i - Th√¥ng tin dinh d∆∞·ª°ng -->
                                <div class="space-y-5">
                                    <div class="bg-white/60 rounded-xl p-4 border border-emerald-100">
                                        <h4 class="text-base font-bold text-emerald-800 mb-4 flex items-center">
                                            <span class="mr-2">üìä</span> Th√¥ng tin dinh d∆∞·ª°ng (tr√™n 100g ho·∫∑c ƒë∆°n v·ªã t∆∞∆°ng ƒë∆∞∆°ng)
                                        </h4>
                                        <p class="text-xs text-emerald-700 mb-4 bg-emerald-50 p-2 rounded-lg border border-emerald-200">
                                            <strong>üí° L∆∞u √Ω:</strong> T·∫•t c·∫£ c√°c gi√° tr·ªã dinh d∆∞·ª°ng b√™n d∆∞·ªõi ƒë∆∞·ª£c t√≠nh tr√™n 100g (ho·∫∑c ƒë∆°n v·ªã t∆∞∆°ng ƒë∆∞∆°ng v·ªõi 100g). V√≠ d·ª•: n·∫øu ƒë∆°n v·ªã l√† "ml", th√¨ t√≠nh tr√™n 100ml; n·∫øu l√† "qu·∫£", th√¨ t√≠nh tr√™n 1 qu·∫£.
                                        </p>
                                        <div class="space-y-4">
                                            <div class="grid grid-cols-2 gap-3">
                                                <div>
                                                    <label for="fat" class="block text-sm font-semibold text-gray-700 mb-1.5">Fat (g)</label>
                                                    <input type="number" name="fat" id="fat" step="0.1" min="0" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                                <div>
                                                    <label for="carbs" class="block text-sm font-semibold text-gray-700 mb-1.5">Carbs (g)</label>
                                                    <input type="number" name="carbs" id="carbs" step="0.1" min="0" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                            </div>
                                            <div class="grid grid-cols-2 gap-3">
                                                <div>
                                                    <label for="protein" class="block text-sm font-semibold text-gray-700 mb-1.5">Protein (g)</label>
                                                    <input type="number" name="protein" id="protein" step="0.1" min="0" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                                <div>
                                                    <label for="cholesterol" class="block text-sm font-semibold text-gray-700 mb-1.5">Cholesterol (mg)</label>
                                                    <input type="number" name="cholesterol" id="cholesterol" step="0.1" min="0" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                            </div>
                                            <div>
                                                <label for="sodium" class="block text-sm font-semibold text-gray-700 mb-1.5">Sodium (mg)</label>
                                                <input type="number" name="sodium" id="sodium" step="0.1" min="0" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Section Chi ti·∫øt Vitamin -->
                                    <div class="bg-white/60 rounded-xl p-4 border border-emerald-100 mt-4">
                                        <h4 class="text-base font-bold text-emerald-800 mb-4 flex items-center">
                                            <span class="mr-2">üíä</span> Chi ti·∫øt Vitamin (% Daily Value)
                                        </h4>
                                        <p class="text-xs text-emerald-700 mb-4 bg-emerald-50 p-2 rounded-lg border border-emerald-200">
                                            <strong>üí° L∆∞u √Ω:</strong> Nh·∫≠p % Daily Value cho t·ª´ng lo·∫°i vitamin. H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông t√≠nh t·ªïng % vitamin trung b√¨nh.
                                        </p>
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label for="vitaminA" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin A (%)</label>
                                                <input type="number" name="vitaminA" id="vitaminA" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminB1" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B1 - Thiamin (%)</label>
                                                <input type="number" name="vitaminB1" id="vitaminB1" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminB2" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B2 - Riboflavin (%)</label>
                                                <input type="number" name="vitaminB2" id="vitaminB2" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminB3" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B3 - Niacin (%)</label>
                                                <input type="number" name="vitaminB3" id="vitaminB3" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminB6" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B6 (%)</label>
                                                <input type="number" name="vitaminB6" id="vitaminB6" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminB9" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B9 - Folate (%)</label>
                                                <input type="number" name="vitaminB9" id="vitaminB9" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminB12" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B12 (%)</label>
                                                <input type="number" name="vitaminB12" id="vitaminB12" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminC" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin C (%)</label>
                                                <input type="number" name="vitaminC" id="vitaminC" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminD" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin D (%)</label>
                                                <input type="number" name="vitaminD" id="vitaminD" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminE" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin E (%)</label>
                                                <input type="number" name="vitaminE" id="vitaminE" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="vitaminK" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin K (%)</label>
                                                <input type="number" name="vitaminK" id="vitaminK" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <label for="vitamin" class="block text-sm font-semibold text-gray-700 mb-1.5">T·ªïng Vitamin (%) - T·ª± ƒë·ªông t√≠nh</label>
                                            <input type="number" name="vitamin" id="vitamin" step="0.1" min="0" max="100" value="0.0" readonly class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-300 bg-emerald-50 shadow-sm text-sm transition-all" placeholder="0.0">
                                            <p class="mt-1 text-xs text-gray-500">Gi√° tr·ªã n√†y ƒë∆∞·ª£c t√≠nh t·ª± ƒë·ªông t·ª´ trung b√¨nh c·ªßa t·∫•t c·∫£ c√°c vitamin tr√™n.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-emerald-50 to-teal-50 px-6 py-4 sm:flex sm:flex-row-reverse sm:gap-3 border-t border-emerald-200">
                            <button type="submit" class="inline-flex w-full justify-center items-center rounded-xl border border-transparent bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 px-8 py-3 text-base font-bold text-white shadow-lg hover:from-emerald-600 hover:via-teal-600 hover:to-cyan-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition-all duration-300 transform hover:scale-105 hover:shadow-xl sm:w-auto">
                                <span class="mr-2">‚úì</span> Th√™m
                            </button>
                            <button type="button" onclick="closeModal('addIngredientModal')" class="mt-3 inline-flex w-full justify-center items-center rounded-xl border-2 border-emerald-300 bg-white px-8 py-3 text-base font-bold text-emerald-700 shadow-md hover:bg-emerald-50 hover:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-offset-2 transition-all duration-300 sm:mt-0 sm:w-auto">
                                <span class="mr-2">‚úï</span> H·ªßy
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Ingredient Modal (t∆∞∆°ng t·ª± foods.html) -->
    <div id="editFoodModal" class="relative z-50 hidden" aria-labelledby="edit-modal-title" role="dialog" aria-modal="true">
        <div class="fixed inset-0 bg-black/40 transition-opacity backdrop-blur-sm"></div>
        <div class="fixed inset-0 z-50 overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
                <div class="relative transform overflow-hidden rounded-2xl bg-gradient-to-br from-white to-emerald-50 text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-5xl border border-emerald-100">
                    <form id="editFoodForm" method="post" enctype="multipart/form-data">
                        <input type="hidden" name="returnToCategory" th:value="${category.id}">
                        <input type="hidden" id="edit-category-id" name="category.id" th:value="${category.id}">
                        <div class="bg-gradient-to-r from-emerald-600 to-teal-600 px-6 pt-5 pb-3">
                            <h3 class="text-2xl font-bold text-white" id="edit-modal-title">Ch·ªânh s·ª≠a nguy√™n li·ªáu</h3>
                        </div>
                        <div class="px-6 pt-5 pb-5 sm:p-6">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- C·ªôt tr√°i - Th√¥ng tin c∆° b·∫£n -->
                                <div class="space-y-5">
                                    <div class="bg-white/60 rounded-xl p-4 border border-emerald-100">
                                        <h4 class="text-base font-bold text-emerald-800 mb-4 flex items-center">
                                            <span class="mr-2">üìù</span> Th√¥ng tin c∆° b·∫£n
                                        </h4>
                                        <div class="space-y-4">
                                            <div>
                                                <label for="edit-name" class="block text-sm font-semibold text-gray-700 mb-1.5">T√™n nguy√™n li·ªáu *</label>
                                                <input type="text" id="edit-name" name="name" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" required>
                                            </div>
                                            <div>
                                                <label for="edit-unit" class="block text-sm font-semibold text-gray-700 mb-1.5">ƒê∆°n v·ªã m·∫∑c ƒë·ªãnh *</label>
                                                <select id="edit-unit" name="unit" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" required>
                                                    <option value="g">g - Gram - 100g</option>
                                                    <option value="kg">kg - Kilogram - 1 kg</option>
                                                    <option value="ml">ml - Milliliter - 100ml</option>
                                                    <option value="l">l - Liter - 1 l</option>
                                                    <option value="qu·∫£">qu·∫£ - Qu·∫£/C√°i - 1 qu·∫£</option>
                                                    <option value="c·ªëc">c·ªëc - C·ªëc - 1 c·ªëc</option>
                                                    <option value="th√¨a canh">th√¨a canh - Th√¨a canh - 1 th√¨a canh</option>
                                                    <option value="th√¨a c√† ph√™">th√¨a c√† ph√™ - Th√¨a c√† ph√™ - 1 th√¨a c√† ph√™</option>
                                                    <option value="l√°t">l√°t - L√°t - 1 l√°t</option>
                                                    <option value="t√©p">t√©p - T√©p - 1 t√©p</option>
                                                </select>
                                                <p class="mt-1 text-xs text-gray-500">ƒê∆°n v·ªã ƒëo l∆∞·ªùng m·∫∑c ƒë·ªãnh cho nguy√™n li·ªáu n√†y. <strong>L∆∞u √Ω:</strong> C√°c th√¥ng tin dinh d∆∞·ª°ng b√™n ph·∫£i ƒë∆∞·ª£c t√≠nh tr√™n 100g (ho·∫∑c ƒë∆°n v·ªã t∆∞∆°ng ƒë∆∞∆°ng).</p>
                                            </div>
                                            <div>
                                                <label for="edit-calories" class="block text-sm font-semibold text-gray-700 mb-1.5">Calories *</label>
                                                <div class="relative">
                                                    <input type="number" id="edit-calories-input" step="0.1" min="0" class="block w-full px-4 py-2.5 pr-16 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="52" required>
                                                    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-sm font-medium text-gray-500">kcal</span>
                                                    <input type="hidden" id="edit-calories" name="calories">
                                                </div>
                                                <p class="mt-1 text-xs text-gray-500">Ch·ªâ c·∫ßn nh·∫≠p s·ªë, h·ªá th·ªëng t·ª± ƒë·ªông th√™m ƒë∆°n v·ªã kcal</p>
                                            </div>
                                            <div>
                                                <label for="edit-description" class="block text-sm font-semibold text-gray-700 mb-1.5">M√¥ t·∫£</label>
                                                <textarea id="edit-description" name="description" rows="4" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all resize-none"></textarea>
                                            </div>
                                            <div>
                                                <label for="edit-imageFile" class="block text-sm font-semibold text-gray-700 mb-1.5">H√¨nh ·∫£nh</label>
                                                <input type="file" name="imageFile" id="edit-imageFile" accept="image/*" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm text-gray-700 text-sm file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-emerald-500 file:text-white hover:file:bg-emerald-600 transition-all">
                                                <p class="mt-1.5 text-xs text-gray-500">ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng mu·ªën thay ƒë·ªïi h√¨nh ·∫£nh</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- C·ªôt ph·∫£i - Th√¥ng tin dinh d∆∞·ª°ng -->
                                <div class="space-y-5">
                                    <div class="bg-white/60 rounded-xl p-4 border border-emerald-100">
                                        <h4 class="text-base font-bold text-emerald-800 mb-4 flex items-center">
                                            <span class="mr-2">üìä</span> Th√¥ng tin dinh d∆∞·ª°ng (tr√™n 100g ho·∫∑c ƒë∆°n v·ªã t∆∞∆°ng ƒë∆∞∆°ng)
                                        </h4>
                                        <p class="text-xs text-emerald-700 mb-4 bg-emerald-50 p-2 rounded-lg border border-emerald-200">
                                            <strong>üí° L∆∞u √Ω:</strong> T·∫•t c·∫£ c√°c gi√° tr·ªã dinh d∆∞·ª°ng b√™n d∆∞·ªõi ƒë∆∞·ª£c t√≠nh tr√™n 100g (ho·∫∑c ƒë∆°n v·ªã t∆∞∆°ng ƒë∆∞∆°ng v·ªõi 100g). V√≠ d·ª•: n·∫øu ƒë∆°n v·ªã l√† "ml", th√¨ t√≠nh tr√™n 100ml; n·∫øu l√† "qu·∫£", th√¨ t√≠nh tr√™n 1 qu·∫£.
                                        </p>
                                        <div class="space-y-4">
                                            <div class="grid grid-cols-2 gap-3">
                                                <div>
                                                    <label for="edit-fat" class="block text-sm font-semibold text-gray-700 mb-1.5">Fat (g)</label>
                                                    <input type="number" id="edit-fat" name="fat" step="0.1" min="0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                                <div>
                                                    <label for="edit-carbs" class="block text-sm font-semibold text-gray-700 mb-1.5">Carbs (g)</label>
                                                    <input type="number" id="edit-carbs" name="carbs" step="0.1" min="0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                            </div>
                                            <div class="grid grid-cols-2 gap-3">
                                                <div>
                                                    <label for="edit-protein" class="block text-sm font-semibold text-gray-700 mb-1.5">Protein (g)</label>
                                                    <input type="number" id="edit-protein" name="protein" step="0.1" min="0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                                <div>
                                                    <label for="edit-cholesterol" class="block text-sm font-semibold text-gray-700 mb-1.5">Cholesterol (mg)</label>
                                                    <input type="number" id="edit-cholesterol" name="cholesterol" step="0.1" min="0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                                </div>
                                            </div>
                                            <div>
                                                <label for="edit-sodium" class="block text-sm font-semibold text-gray-700 mb-1.5">Sodium (mg)</label>
                                                <input type="number" id="edit-sodium" name="sodium" step="0.1" min="0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Section Chi ti·∫øt Vitamin -->
                                    <div class="bg-white/60 rounded-xl p-4 border border-emerald-100 mt-4">
                                        <h4 class="text-base font-bold text-emerald-800 mb-4 flex items-center">
                                            <span class="mr-2">üíä</span> Chi ti·∫øt Vitamin (% Daily Value)
                                        </h4>
                                        <p class="text-xs text-emerald-700 mb-4 bg-emerald-50 p-2 rounded-lg border border-emerald-200">
                                            <strong>üí° L∆∞u √Ω:</strong> Nh·∫≠p % Daily Value cho t·ª´ng lo·∫°i vitamin. H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông t√≠nh t·ªïng % vitamin trung b√¨nh.
                                        </p>
                                        <div class="grid grid-cols-2 gap-3">
                                            <div>
                                                <label for="edit-vitaminA" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin A (%)</label>
                                                <input type="number" id="edit-vitaminA" name="vitaminA" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminB1" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B1 - Thiamin (%)</label>
                                                <input type="number" id="edit-vitaminB1" name="vitaminB1" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminB2" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B2 - Riboflavin (%)</label>
                                                <input type="number" id="edit-vitaminB2" name="vitaminB2" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminB3" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B3 - Niacin (%)</label>
                                                <input type="number" id="edit-vitaminB3" name="vitaminB3" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminB6" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B6 (%)</label>
                                                <input type="number" id="edit-vitaminB6" name="vitaminB6" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminB9" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B9 - Folate (%)</label>
                                                <input type="number" id="edit-vitaminB9" name="vitaminB9" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminB12" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin B12 (%)</label>
                                                <input type="number" id="edit-vitaminB12" name="vitaminB12" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminC" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin C (%)</label>
                                                <input type="number" id="edit-vitaminC" name="vitaminC" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminD" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin D (%)</label>
                                                <input type="number" id="edit-vitaminD" name="vitaminD" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminE" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin E (%)</label>
                                                <input type="number" id="edit-vitaminE" name="vitaminE" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                            <div>
                                                <label for="edit-vitaminK" class="block text-sm font-semibold text-gray-700 mb-1.5">Vitamin K (%)</label>
                                                <input type="number" id="edit-vitaminK" name="vitaminK" step="0.1" min="0" max="100" value="0.0" class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-200 bg-white shadow-sm focus:border-emerald-500 focus:ring-2 focus:ring-emerald-300 text-sm transition-all" placeholder="0.0">
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <label for="edit-vitamin" class="block text-sm font-semibold text-gray-700 mb-1.5">T·ªïng Vitamin (%) - T·ª± ƒë·ªông t√≠nh</label>
                                            <input type="number" id="edit-vitamin" name="vitamin" step="0.1" min="0" max="100" value="0.0" readonly class="block w-full px-4 py-2.5 rounded-lg border-2 border-emerald-300 bg-emerald-50 shadow-sm text-sm transition-all" placeholder="0.0">
                                            <p class="mt-1 text-xs text-gray-500">Gi√° tr·ªã n√†y ƒë∆∞·ª£c t√≠nh t·ª± ƒë·ªông t·ª´ trung b√¨nh c·ªßa t·∫•t c·∫£ c√°c vitamin tr√™n.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gradient-to-r from-emerald-50 to-teal-50 px-6 py-4 sm:flex sm:flex-row-reverse sm:gap-3 border-t border-emerald-200">
                            <button type="submit" class="inline-flex w-full justify-center items-center rounded-xl border border-transparent bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 px-8 py-3 text-base font-bold text-white shadow-lg hover:from-emerald-600 hover:via-teal-600 hover:to-cyan-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition-all duration-300 transform hover:scale-105 hover:shadow-xl sm:w-auto">
                                <span class="mr-2">‚úì</span> L∆∞u thay ƒë·ªïi
                            </button>
                            <button type="button" onclick="closeModal('editFoodModal')" class="mt-3 inline-flex w-full justify-center items-center rounded-xl border-2 border-emerald-300 bg-white px-8 py-3 text-base font-bold text-emerald-700 shadow-md hover:bg-emerald-50 hover:border-emerald-400 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-offset-2 transition-all duration-300 sm:mt-0 sm:w-auto">
                                <span class="mr-2">‚úï</span> H·ªßy
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }
        
        function updateCaloriesValue() {
            const input = document.getElementById('calories');
            const hidden = document.getElementById('calories-hidden');
            if (input && hidden && input.value) {
                hidden.value = input.value + ' kcal';
            }
        }
        
        function calculateTotalVitamin() {
            const vitamins = ['vitaminA', 'vitaminB1', 'vitaminB2', 'vitaminB3', 'vitaminB6', 
                            'vitaminB9', 'vitaminB12', 'vitaminC', 'vitaminD', 'vitaminE', 'vitaminK'];
            let total = 0;
            let count = 0;
            
            vitamins.forEach(function(vitaminId) {
                const input = document.getElementById(vitaminId);
                if (input && input.value) {
                    const value = parseFloat(input.value) || 0;
                    total += value;
                    count++;
                }
            });
            
            const totalVitaminInput = document.getElementById('vitamin');
            if (totalVitaminInput) {
                const average = count > 0 ? (total / count).toFixed(1) : 0.0;
                totalVitaminInput.value = average;
            }
        }
        
        function calculateTotalVitaminEdit() {
            const vitamins = ['edit-vitaminA', 'edit-vitaminB1', 'edit-vitaminB2', 'edit-vitaminB3', 'edit-vitaminB6', 
                            'edit-vitaminB9', 'edit-vitaminB12', 'edit-vitaminC', 'edit-vitaminD', 'edit-vitaminE', 'edit-vitaminK'];
            let total = 0;
            let count = 0;
            
            vitamins.forEach(function(vitaminId) {
                const input = document.getElementById(vitaminId);
                if (input && input.value) {
                    const value = parseFloat(input.value) || 0;
                    total += value;
                    count++;
                }
            });
            
            const totalVitaminInput = document.getElementById('edit-vitamin');
            if (totalVitaminInput) {
                const average = count > 0 ? (total / count).toFixed(1) : 0.0;
                totalVitaminInput.value = average;
            }
        }
        
        // T√≠nh t·ªïng vitamin khi ng∆∞·ªùi d√πng nh·∫≠p
        document.addEventListener('DOMContentLoaded', function() {
            const vitaminInputs = ['vitaminA', 'vitaminB1', 'vitaminB2', 'vitaminB3', 'vitaminB6', 
                                 'vitaminB9', 'vitaminB12', 'vitaminC', 'vitaminD', 'vitaminE', 'vitaminK'];
            vitaminInputs.forEach(function(vitaminId) {
                const input = document.getElementById(vitaminId);
                if (input) {
                    input.addEventListener('input', calculateTotalVitamin);
                    input.addEventListener('change', calculateTotalVitamin);
                }
            });
            
            // T√≠nh t·ªïng vitamin cho form edit
            const editVitaminInputs = ['edit-vitaminA', 'edit-vitaminB1', 'edit-vitaminB2', 'edit-vitaminB3', 'edit-vitaminB6', 
                                     'edit-vitaminB9', 'edit-vitaminB12', 'edit-vitaminC', 'edit-vitaminD', 'edit-vitaminE', 'edit-vitaminK'];
            editVitaminInputs.forEach(function(vitaminId) {
                const input = document.getElementById(vitaminId);
                if (input) {
                    input.addEventListener('input', calculateTotalVitaminEdit);
                    input.addEventListener('change', calculateTotalVitaminEdit);
                }
            });
            
            // T√≠nh t·ªïng vitamin khi form ƒë∆∞·ª£c submit
            const form = document.querySelector('form[th\\:action="@{/admin/foods}"]');
            if (form) {
                form.addEventListener('submit', function(e) {
                    calculateTotalVitamin();
                });
            }
            
            const editForm = document.getElementById('editFoodForm');
            if (editForm) {
                editForm.addEventListener('submit', function(e) {
                    calculateTotalVitaminEdit();
                });
            }
        });
        
        // Update calories when form is submitted
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('form[th\\:action="@{/admin/foods}"]');
            if (form) {
                form.addEventListener('submit', function(e) {
                    updateCaloriesValue();
                });
            }
            
            // Handle edit button clicks
            document.querySelectorAll('.edit-food-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    const name = this.getAttribute('data-name') || '';
                    const categoryId = this.getAttribute('data-category-id') || '';
                    const calories = this.getAttribute('data-calories') || '';
                    const description = this.getAttribute('data-description') || '';
                    const unit = this.getAttribute('data-unit') || 'g';
                    const fat = this.getAttribute('data-fat') || '0.0';
                    const carbs = this.getAttribute('data-carbs') || '0.0';
                    const protein = this.getAttribute('data-protein') || '0.0';
                    const cholesterol = this.getAttribute('data-cholesterol') || '0.0';
                    const sodium = this.getAttribute('data-sodium') || '0.0';
                    const vitamin = this.getAttribute('data-vitamin') || '0.0';
                    const vitaminA = this.getAttribute('data-vitamin-a') || '0.0';
                    const vitaminB1 = this.getAttribute('data-vitamin-b1') || '0.0';
                    const vitaminB2 = this.getAttribute('data-vitamin-b2') || '0.0';
                    const vitaminB3 = this.getAttribute('data-vitamin-b3') || '0.0';
                    const vitaminB6 = this.getAttribute('data-vitamin-b6') || '0.0';
                    const vitaminB9 = this.getAttribute('data-vitamin-b9') || '0.0';
                    const vitaminB12 = this.getAttribute('data-vitamin-b12') || '0.0';
                    const vitaminC = this.getAttribute('data-vitamin-c') || '0.0';
                    const vitaminD = this.getAttribute('data-vitamin-d') || '0.0';
                    const vitaminE = this.getAttribute('data-vitamin-e') || '0.0';
                    const vitaminK = this.getAttribute('data-vitamin-k') || '0.0';
                    
                    // Set form action
                    document.getElementById('editFoodForm').action = '/admin/foods/' + id + '/edit';
                    
                    // Set returnToCategory if exists
                    const returnToCategoryInput = document.querySelector('#editFoodForm input[name="returnToCategory"]');
                    if (returnToCategoryInput) {
                        returnToCategoryInput.value = categoryId;
                    }
                    
                    // Set category.id
                    const categoryIdInput = document.getElementById('edit-category-id');
                    if (categoryIdInput) {
                        categoryIdInput.value = categoryId;
                    }
                    
                    // Fill form fields
                    document.getElementById('edit-name').value = name;
                    document.getElementById('edit-unit').value = unit;
                    
                    // Extract number from calories (e.g., "52 kcal" -> "52")
                    const caloriesNumber = calories.replace(/\s*kcal\s*/i, '').trim();
                    document.getElementById('edit-calories-input').value = caloriesNumber;
                    document.getElementById('edit-calories').value = calories;
                    
                    document.getElementById('edit-description').value = description;
                    document.getElementById('edit-fat').value = fat;
                    document.getElementById('edit-carbs').value = carbs;
                    document.getElementById('edit-protein').value = protein;
                    document.getElementById('edit-cholesterol').value = cholesterol;
                    document.getElementById('edit-sodium').value = sodium;
                    
                    // Set vitamin chi ti·∫øt
                    document.getElementById('edit-vitaminA').value = vitaminA;
                    document.getElementById('edit-vitaminB1').value = vitaminB1;
                    document.getElementById('edit-vitaminB2').value = vitaminB2;
                    document.getElementById('edit-vitaminB3').value = vitaminB3;
                    document.getElementById('edit-vitaminB6').value = vitaminB6;
                    document.getElementById('edit-vitaminB9').value = vitaminB9;
                    document.getElementById('edit-vitaminB12').value = vitaminB12;
                    document.getElementById('edit-vitaminC').value = vitaminC;
                    document.getElementById('edit-vitaminD').value = vitaminD;
                    document.getElementById('edit-vitaminE').value = vitaminE;
                    document.getElementById('edit-vitaminK').value = vitaminK;
                    
                    // T√≠nh t·ªïng vitamin sau khi set c√°c gi√° tr·ªã
                    calculateTotalVitaminEdit();
                    
                    // Open modal
                    openModal('editFoodModal');
                });
            });
            
            // Update edit form calories on input change
            const editCaloriesInput = document.getElementById('edit-calories-input');
            if (editCaloriesInput) {
                editCaloriesInput.addEventListener('input', function() {
                    const hidden = document.getElementById('edit-calories');
                    if (hidden && this.value) {
                        hidden.value = this.value + ' kcal';
                    }
                });
            }
            
            // Update edit form calories on submit
            const editForm = document.getElementById('editFoodForm');
            if (editForm) {
                editForm.addEventListener('submit', function(e) {
                    const input = document.getElementById('edit-calories-input');
                    const hidden = document.getElementById('edit-calories');
                    if (input && hidden && input.value) {
                        hidden.value = input.value + ' kcal';
                    }
                });
            }
        });
    </script>
</div>
</html>

